{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h3><i class="fas fa-edit"></i> Compose Bulk Email</h3>
            </div>
            <div class="card-body">
                <form action="{{ url_for('send_emails') }}" method="post" enctype="multipart/form-data">
                    <input type="hidden" name="filename" value="{{ filename }}">
                    <input type="hidden" name="attachment_filename" id="attachment_filename" value="">
                    
                    <!-- Sender Selection -->
                    <div class="card mb-4">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="fas fa-user"></i> Sender Selection</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="sender_mode" class="form-label">Sending Mode:</label>
                                <select class="form-select" id="sender_mode" name="sender_mode" required onchange="toggleSenderOptions()">
                                    <option value="">Select sending mode</option>
                                    <option value="auto" selected>Auto-rotate (Recommended)</option>
                                    <option value="manual">Select specific account</option>
                                </select>
                                <div class="form-text">Auto-rotate distributes emails across all available accounts automatically</div>
                            </div>

                            <div id="manual-sender-section" style="display: none;">
                                <div class="mb-3">
                                    <label for="selected_sender" class="form-label">Select Email Account:</label>
                                    <select class="form-select" id="selected_sender" name="selected_sender" onchange="updateDefaultCcBcc()">
                                        <option value="">Choose an email account</option>
                                        {% for account in account_stats %}
                                        <option value="{{ account.email }}" 
                                                {% if account.remaining == 0 %}disabled{% endif %}
                                                data-remaining="{{ account.remaining }}"
                                                data-sent="{{ account.sent_today }}"
                                                data-default-cc="{{ account.default_cc or '' }}"
                                                data-default-bcc="{{ account.default_bcc or '' }}">
                                            {{ account.email }} 
                                            ({{ account.remaining }}/{{ account.limit }} remaining)
                                            {% if account.remaining == 0 %} - LIMIT REACHED{% endif %}
                                        </option>
                                        {% endfor %}
                                    </select>
                                    <div class="form-text">Select a specific account to send all emails from</div>
                                </div>

                                <!-- Default CC/BCC Info Display -->
                                <div id="account-defaults-info" style="display: none;">
                                    <div class="alert alert-info">
                                        <h6><i class="fas fa-info-circle"></i> Account Default Recipients:</h6>
                                        <div id="default-cc-display" style="display: none;">
                                            <strong>Default CC:</strong> <span id="default-cc-text"></span>
                                        </div>
                                        <div id="default-bcc-display" style="display: none;">
                                            <strong>Default BCC:</strong> <span id="default-bcc-text"></span>
                                        </div>
                                        <small class="text-muted">These will be automatically merged with any CC/BCC you specify below.</small>
                                    </div>
                                </div>
                            </div>

                            <!-- Auto-mode CC/BCC info -->
                            <div id="auto-mode-defaults" style="display: none;">
                                <div class="alert alert-warning">
                                    <h6><i class="fas fa-info-circle"></i> Auto-rotate Mode:</h6>
                                    <p class="mb-1">Each account will use its own default CC/BCC settings plus any additional recipients you specify below.</p>
                                    <small class="text-muted">View individual account defaults in <a href="{{ url_for('manage_accounts') }}" target="_blank">Account Management</a>.</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Email Configuration -->
                    <div class="card mb-4">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0"><i class="fas fa-envelope"></i> Email Configuration</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="email_column" class="form-label">Email Column (TO):</label>
                                <select class="form-select" id="email_column" name="email_column" required>
                                    <option value="">Select the column containing email addresses</option>
                                    {% for column in columns %}
                                        <option value="{{ column }}" 
                                            {% if 'email' in column.lower() or 'mail' in column.lower() %}selected{% endif %}>
                                            {{ column }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="cc_emails" class="form-label">Additional CC Emails:</label>
                                        <input type="text" class="form-control" id="cc_emails" name="cc_emails" 
                                               placeholder="cc1@example.com, cc2@example.com">
                                        <div class="form-text">
                                            <span id="cc-help-text">Comma-separated emails to CC on all messages</span>
                                            <div id="cc-merge-info" style="display: none;" class="text-info">
                                                <small><i class="fas fa-plus"></i> Will be merged with account default CC</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="mb-3">
                                        <label for="bcc_emails" class="form-label">Additional BCC Emails:</label>
                                        <input type="text" class="form-control" id="bcc_emails" name="bcc_emails" 
                                               placeholder="bcc1@example.com, bcc2@example.com">
                                        <div class="form-text">
                                            <span id="bcc-help-text">Comma-separated emails to BCC on all messages</span>
                                            <div id="bcc-merge-info" style="display: none;" class="text-info">
                                                <small><i class="fas fa-plus"></i> Will be merged with account default BCC</small>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="subject" class="form-label">Email Subject:</label>
                                <input type="text" class="form-control" id="subject" name="subject" required 
                                       placeholder="Your email subject here">
                            </div>

                            <div class="mb-3">
                                <label for="template" class="form-label">Email Template:</label>
                                <div class="mb-2">
                                    <small class="text-muted">
                                        <i class="fas fa-info-circle"></i> 
                                        <strong>Formatting preserved:</strong> Line breaks, spaces, bullet points, and emojis will be maintained as you type them.
                                    </small>
                                </div>
                                <textarea class="form-control template-editor" id="template" name="template" required 
                                          placeholder="Write your email template here. Use placeholders like {Name}, {Company} to personalize emails.

Example:
Hi {Name} ðŸ‘‹

We hope you're doing well! Here are some key points:

â€¢ Point 1 with proper spacing
â€¢ Point 2 with emojis ðŸ“§
â€¢ Point 3 with line breaks

Best regards,
Your Team ðŸ˜Š"></textarea>
                                <div class="form-text">
                                    Available placeholders: 
                                    {% for column in columns %}
                                        <span class="placeholder-tag" onclick="insertPlaceholder('{{ column }}')">{{ column }}</span>
                                    {% endfor %}
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="delay" class="form-label">Delay between emails (seconds):</label>
                                <input type="number" class="form-control" id="delay" name="delay" value="5" min="1" max="10">
                                <div class="form-text">Recommended: 3-5 seconds to avoid being flagged as spam</div>
                            </div>
                        </div>
                    </div>

                    <!-- Attachment Section -->
                    <div class="card mb-4">
                        <div class="card-header bg-warning text-white">
                            <h5 class="mb-0"><i class="fas fa-paperclip"></i> Attachment (Optional)</h5>
                        </div>
                        <div class="card-body">
                            <div class="mb-3">
                                <label for="attachment" class="form-label">Select Attachment:</label>
                                <input type="file" class="form-control" id="attachment" accept=".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,.gif">
                                <div class="form-text">Supported formats: PDF, DOC, DOCX, TXT, JPG, PNG, GIF (Max: 25MB)</div>
                            </div>
                            
                            <div id="attachment-status" class="mt-3" style="display: none;">
                                <div class="alert alert-info">
                                    <i class="fas fa-paperclip"></i>
                                    <strong>Attached:</strong> <span id="attachment-name"></span>
                                    <span class="badge bg-secondary ms-2" id="attachment-size"></span>
                                    <button type="button" class="btn btn-sm btn-outline-danger ms-2" onclick="removeAttachment()">
                                        <i class="fas fa-times"></i> Remove
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Final Recipients Summary -->
                    <div class="card mb-4" id="recipients-summary" style="display: none;">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0"><i class="fas fa-users"></i> Final Recipients Summary</h5>
                        </div>
                        <div class="card-body">
                            <div id="final-recipients-content">
                                <!-- Dynamic content populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <!-- Submit Section -->
                    <div class="text-center">
                        {% if account_stats %}
                            <button type="submit" class="btn btn-success btn-lg" id="sendButton">
                                <i class="fas fa-paper-plane"></i> Send Bulk Emails
                            </button>
                        {% else %}
                            <div class="alert alert-warning">
                                <h5><i class="fas fa-exclamation-triangle"></i> No Email Accounts Configured</h5>
                                <p>You need to add at least one email account before sending bulk emails.</p>
                                <a href="{{ url_for('manage_accounts') }}" class="btn btn-primary">
                                    <i class="fas fa-plus"></i> Add Email Account
                                </a>
                            </div>
                        {% endif %}
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="col-md-4">
        <!-- Sample Data Preview -->
        <div class="card">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-table"></i> Sample Data Preview</h5>
            </div>
            <div class="card-body">
                {% if sample_data %}
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead>
                                <tr>
                                    {% for column in columns %}
                                        <th>{{ column }}</th>
                                    {% endfor %}
                                </tr>
                            </thead>
                            <tbody>
                                {% for row in sample_data %}
                                <tr>
                                    {% for column in columns %}
                                        <td>{{ row[column] or '' }}</td>
                                    {% endfor %}
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                {% else %}
                    <p class="text-muted">No sample data available</p>
                {% endif %}
            </div>
        </div>

        <!-- Account Summary -->
        {% if account_stats %}
        <div class="card mt-4">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0"><i class="fas fa-chart-bar"></i> Account Summary</h5>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-6">
                        <h4 class="text-success">{{ account_stats|selectattr("is_active")|list|length }}</h4>
                        <small>Active Accounts</small>
                    </div>
                    <div class="col-6">
                        <h4 class="text-info">{{ account_stats|selectattr("is_active")|sum(attribute='remaining') }}</h4>
                        <small>Total Remaining</small>
                    </div>
                </div>
                
                <hr>
                
                <div class="account-list">
                    {% for account in account_stats %}
                        {% if account.is_active %}
                        <div class="account-item mb-2 p-2 border rounded">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <strong>{{ account.email }}</strong>
                                    <div class="small text-muted">
                                        {{ account.sent_today }}/{{ account.limit }} used
                                        {% if account.default_cc or account.default_bcc %}
                                            <br>
                                            {% if account.default_cc %}
                                                <i class="fas fa-copy text-primary" title="Default CC"></i>
                                            {% endif %}
                                            {% if account.default_bcc %}
                                                <i class="fas fa-eye-slash text-secondary" title="Default BCC"></i>
                                            {% endif %}
                                            <span class="text-info">Has defaults</span>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="text-end">
                                    <div class="progress" style="width: 60px; height: 8px;">
                                        <div class="progress-bar {% if account.percentage_used < 70 %}bg-success{% elif account.percentage_used < 90 %}bg-warning{% else %}bg-danger{% endif %}" 
                                             style="width: {{ account.percentage_used }}%"></div>
                                    </div>
                                    <small class="text-{% if account.remaining > 5 %}success{% elif account.remaining > 0 %}warning{% else %}danger{% endif %}">
                                        {{ account.remaining }} left
                                    </small>
                                </div>
                            </div>
                        </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Email Preview -->
        <div class="card mt-4">
            <div class="card-header bg-warning text-white">
                <h5 class="mb-0"><i class="fas fa-eye"></i> Email Preview</h5>
            </div>
            <div class="card-body">
                <div id="preview-content">
                    <p class="text-muted">Enter a subject and template to see preview</p>
                </div>
                <div class="mt-3">
                    <button type="button" class="btn btn-sm btn-outline-primary" onclick="updatePreview()">
                        <i class="fas fa-refresh"></i> Update Preview
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Define columns and sample data globally
const columns = {{ columns | tojson }};
const sampleData = {% if sample_data and sample_data|length > 0 %}{{ sample_data[0] | tojson }}{% else %}{}{% endif %};
const accountStats = {{ account_stats | tojson }};

function toggleSenderOptions() {
    const senderMode = document.getElementById('sender_mode').value;
    const manualSection = document.getElementById('manual-sender-section');
    const autoDefaults = document.getElementById('auto-mode-defaults');
    const selectedSender = document.getElementById('selected_sender');
    
    if (senderMode === 'manual') {
        manualSection.style.display = 'block';
        autoDefaults.style.display = 'none';
        selectedSender.setAttribute('required', 'required');
    } else if (senderMode === 'auto') {
        manualSection.style.display = 'none';
        autoDefaults.style.display = 'block';
        selectedSender.removeAttribute('required');
        selectedSender.value = '';
        hideAccountDefaults();
    } else {
        manualSection.style.display = 'none';
        autoDefaults.style.display = 'none';
        selectedSender.removeAttribute('required');
        selectedSender.value = '';
        hideAccountDefaults();
    }
    
    updateCcBccLabels();
    updateRecipientsDisplay();
    validateForm();
}

function updateDefaultCcBcc() {
    const selectedSender = document.getElementById('selected_sender');
    const selectedOption = selectedSender.options[selectedSender.selectedIndex];
    
    if (selectedOption && selectedOption.value) {
        const defaultCc = selectedOption.getAttribute('data-default-cc') || '';
        const defaultBcc = selectedOption.getAttribute('data-default-bcc') || '';
        
        showAccountDefaults(defaultCc, defaultBcc);
    } else {
        hideAccountDefaults();
    }
    
    updateCcBccLabels();
    updateRecipientsDisplay();
    validateForm();
}

function showAccountDefaults(defaultCc, defaultBcc) {
    const infoDiv = document.getElementById('account-defaults-info');
    const ccDisplay = document.getElementById('default-cc-display');
    const bccDisplay = document.getElementById('default-bcc-display');
    const ccText = document.getElementById('default-cc-text');
    const bccText = document.getElementById('default-bcc-text');
    
    if (defaultCc || defaultBcc) {
        infoDiv.style.display = 'block';
        
        if (defaultCc) {
            ccDisplay.style.display = 'block';
            ccText.textContent = defaultCc;
        } else {
            ccDisplay.style.display = 'none';
        }
        
        if (defaultBcc) {
            bccDisplay.style.display = 'block';
            bccText.textContent = defaultBcc;
        } else {
            bccDisplay.style.display = 'none';
        }
    } else {
        infoDiv.style.display = 'none';
    }
}

function hideAccountDefaults() {
    document.getElementById('account-defaults-info').style.display = 'none';
}

function updateCcBccLabels() {
    const senderMode = document.getElementById('sender_mode').value;
    const selectedSender = document.getElementById('selected_sender');
    const ccMergeInfo = document.getElementById('cc-merge-info');
    const bccMergeInfo = document.getElementById('bcc-merge-info');
    
    let showMergeInfo = false;
    
    if (senderMode === 'manual' && selectedSender.value) {
        const selectedOption = selectedSender.options[selectedSender.selectedIndex];
        const defaultCc = selectedOption.getAttribute('data-default-cc') || '';
        const defaultBcc = selectedOption.getAttribute('data-default-bcc') || '';
        
        if (defaultCc || defaultBcc) {
            showMergeInfo = true;
        }
    }
    
    ccMergeInfo.style.display = showMergeInfo ? 'block' : 'none';
    bccMergeInfo.style.display = showMergeInfo ? 'block' : 'none';
}

function updateRecipientsDisplay() {
    const summaryCard = document.getElementById('recipients-summary');
    const content = document.getElementById('final-recipients-content');
    const senderMode = document.getElementById('sender_mode').value;
    const formCc = document.getElementById('cc_emails').value.trim();
    const formBcc = document.getElementById('bcc_emails').value.trim();
    
    let html = '';
    let hasRecipients = false;
    
    if (senderMode === 'manual') {
        const selectedSender = document.getElementById('selected_sender');
        if (selectedSender.value) {
            const selectedOption = selectedSender.options[selectedSender.selectedIndex];
            const defaultCc = selectedOption.getAttribute('data-default-cc') || '';
            const defaultBcc = selectedOption.getAttribute('data-default-bcc') || '';
            
            // Merge CC/BCC
            const finalCc = mergeLists(formCc, defaultCc);
            const finalBcc = mergeLists(formBcc, defaultBcc);
            
            if (finalCc.length > 0 || finalBcc.length > 0) {
                hasRecipients = true;
                html = '<div class="row">';
                
                if (finalCc.length > 0) {
                    html += `<div class="col-md-6">
                        <h6><i class="fas fa-copy text-primary"></i> Final CC Recipients:</h6>
                        <ul class="list-unstyled small">`;
                    finalCc.forEach(email => {
                        const isDefault = defaultCc.includes(email);
                        html += `<li>${email} ${isDefault ? '<span class="badge bg-secondary">default</span>' : '<span class="badge bg-info">added</span>'}</li>`;
                    });
                    html += '</ul></div>';
                }
                
                if (finalBcc.length > 0) {
                    html += `<div class="col-md-6">
                        <h6><i class="fas fa-eye-slash text-secondary"></i> Final BCC Recipients:</h6>
                        <ul class="list-unstyled small">`;
                    finalBcc.forEach(email => {
                        const isDefault = defaultBcc.includes(email);
                        html += `<li>${email} ${isDefault ? '<span class="badge bg-secondary">default</span>' : '<span class="badge bg-info">added</span>'}</li>`;
                    });
                    html += '</ul></div>';
                }
                
                html += '</div>';
            }
        }
    } else if (senderMode === 'auto' && (formCc || formBcc)) {
        hasRecipients = true;
        html = '<div class="alert alert-info">';
        html += '<h6><i class="fas fa-info-circle"></i> Auto-rotate Mode Recipients:</h6>';
        
        if (formCc) {
            html += `<p><strong>Additional CC:</strong> ${formCc}</p>`;
        }
        if (formBcc) {
            html += `<p><strong>Additional BCC:</strong> ${formBcc}</p>`;
        }
        
        html += '<small class="text-muted">Each account will also use its own default CC/BCC settings.</small>';
        html += '</div>';
    }
    
    if (hasRecipients) {
        content.innerHTML = html;
        summaryCard.style.display = 'block';
    } else {
        summaryCard.style.display = 'none';
    }
}

function mergeLists(formList, defaultList) {
    const formEmails = formList ? formList.split(',').map(email => email.trim()).filter(email => email) : [];
    const defaultEmails = defaultList ? defaultList.split(',').map(email => email.trim()).filter(email => email) : [];
    
    // Remove duplicates while preserving order
    const merged = [...new Set([...formEmails, ...defaultEmails])];
    return merged;
}

function validateForm() {
    const senderMode = document.getElementById('sender_mode').value;
    const selectedSender = document.getElementById('selected_sender').value;
    const sendButton = document.getElementById('sendButton');
    
    // Don't disable the button if it doesn't exist (no accounts configured)
    if (!sendButton) return;
    
    if (senderMode === 'manual' && !selectedSender) {
        sendButton.disabled = true;
        sendButton.innerHTML = '<i class="fas fa-times"></i> Select Email Account';
        sendButton.classList.remove('btn-success');
        sendButton.classList.add('btn-warning');
    } else if (senderMode === 'manual' && selectedSender) {
        const option = document.querySelector(`#selected_sender option[value="${selectedSender}"]`);
        const remaining = option ? parseInt(option.getAttribute('data-remaining')) : 0;
        
        if (remaining === 0) {
            sendButton.disabled = true;
            sendButton.innerHTML = '<i class="fas fa-times"></i> Account Limit Reached';
            sendButton.classList.remove('btn-success');
            sendButton.classList.add('btn-danger');
        } else {
            sendButton.disabled = false;
            sendButton.innerHTML = '<i class="fas fa-paper-plane"></i> Send Bulk Emails';
            sendButton.classList.remove('btn-warning', 'btn-danger');
            sendButton.classList.add('btn-success');
        }
    } else {
        sendButton.disabled = false;
        sendButton.innerHTML = '<i class="fas fa-paper-plane"></i> Send Bulk Emails';
        sendButton.classList.remove('btn-warning', 'btn-danger');
        sendButton.classList.add('btn-success');
    }
}

function insertPlaceholder(columnName) {
    const template = document.getElementById('template');
    const placeholder = '{' + columnName + '}';
    const start = template.selectionStart;
    const end = template.selectionEnd;
    const text = template.value;
    const before = text.substring(0, start);
    const after = text.substring(end, text.length);
    template.value = before + placeholder + after;
    template.selectionStart = template.selectionEnd = start + placeholder.length;
    template.focus();
    updatePreview();
}

function updatePreview() {
    const subject = document.getElementById('subject').value;
    const template = document.getElementById('template').value;
    const previewContent = document.getElementById('preview-content');
    
    if (subject && template && Object.keys(sampleData).length > 0) {
        let previewSubject = subject;
        let previewBody = template;
        
        // Replace placeholders with sample data
        for (const [key, value] of Object.entries(sampleData)) {
            const placeholder = '{' + key + '}';
            previewSubject = previewSubject.replace(new RegExp(placeholder.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g'), value || `[${key}]`);
            previewBody = previewBody.replace(new RegExp(placeholder.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g'), value || `[${key}]`);
        }
        
        // Format the preview
        previewBody = previewBody.replace(/\n/g, '<br>');
        
        previewContent.innerHTML = `
            <div class="border rounded p-3">
                <h6 class="text-primary border-bottom pb-2">Subject: ${previewSubject}</h6>
                <div class="mt-2">${previewBody}</div>
            </div>
        `;
    } else {
        previewContent.innerHTML = '<p class="text-muted">Enter a subject and template to see preview</p>';
    }
}

// File upload handling
document.getElementById('attachment').addEventListener('change', function(e) {
    const file = e.target.files[0];
    if (file) {
        const formData = new FormData();
        formData.append('attachment', file);
        
        fetch('/upload_attachment', {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                document.getElementById('attachment_filename').value = data.filename;
                document.getElementById('attachment-name').textContent = data.filename;
                document.getElementById('attachment-size').textContent = data.size;
                document.getElementById('attachment-status').style.display = 'block';
            } else {
                alert('Upload failed: ' + data.message);
                e.target.value = '';
            }
        })
        .catch(error => {
            console.error('Upload error:', error);
            alert('Upload failed. Please try again.');
            e.target.value = '';
        });
    }
});

function removeAttachment() {
    document.getElementById('attachment').value = '';
    document.getElementById('attachment_filename').value = '';
    document.getElementById('attachment-status').style.display = 'none';
}

// Event listeners
document.addEventListener('DOMContentLoaded', function() {
    // Initial setup
    toggleSenderOptions();
    updatePreview();
    
    // Auto-update preview when fields change
    document.getElementById('subject').addEventListener('input', updatePreview);
    document.getElementById('template').addEventListener('input', updatePreview);
    
    // Update recipients display when CC/BCC changes
    document.getElementById('cc_emails').addEventListener('input', updateRecipientsDisplay);
    document.getElementById('bcc_emails').addEventListener('input', updateRecipientsDisplay);
    
    // Form validation on change
    document.getElementById('sender_mode').addEventListener('change', validateForm);
    document.getElementById('selected_sender').addEventListener('change', validateForm);
});
</script>

<style>
.template-editor {
    height: 200px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    line-height: 1.5;
}

.placeholder-tag {
    display: inline-block;
    background-color: #e9ecef;
    color: #495057;
    padding: 2px 6px;
    margin: 2px;
    border-radius: 3px;
    cursor: pointer;
    font-size: 0.8em;
    border: 1px solid #ced4da;
}

.placeholder-tag:hover {
    background-color: #007bff;
    color: white;
}

.progress {
    border-radius: 10px;
}

.account-item {
    font-size: 0.9em;
}

.account-item .progress {
    height: 6px;
}

.card {
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    border: 1px solid rgba(0, 0, 0, 0.125);
}

.card-header {
    border-bottom: 1px solid rgba(0, 0, 0, 0.125);
}

.badge {
    font-size: 0.7em;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    .col-md-4 .card {
        margin-top: 1rem;
    }
    
    .account-item {
        font-size: 0.8em;
    }
}
</style>
{% endblock %}